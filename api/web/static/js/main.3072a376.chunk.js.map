{"version":3,"sources":["../node_modules/suneditor/src/lang sync /^/.//.*/.js$","data/external-tools.js","components/icons/CreateNarrativeContextIcon.jsx","components/icons/ImportNarrativeContextIcon.jsx","utils/id-generator.js","utils/array-utils.js","models/base-element.js","models/paragraph-element.js","models/container-element.js","models/shop-item.js","models/shop-element.js","utils/elements-factory.js","models/narrative-category.js","models/narrative-context.js","utils/narrative-context-importer.js","components/Home.jsx","components/CreateNarrativeContext.jsx","components/icons/CreateIcon.jsx","components/icons/ScrollIcon.jsx","components/icons/FolderIcon.jsx","components/icons/ShopIcon.jsx","components/CreateElementButton.jsx","components/icons/RenameIcon.jsx","components/icons/MoveUpIcon.jsx","components/icons/MoveDownIcon.jsx","components/icons/DeleteIcon.jsx","components/icons/CollapseIcon.jsx","components/icons/ExpandIcon.jsx","components/ElementListItem.jsx","components/NarrativeCategoryComponent.jsx","components/icons/ExportNarrativeContextIcon.jsx","components/ViewNarrativeContext.jsx","components/RichTextEditor.jsx","config.js","repositories/web-api-repository.js","repositories/dnd5e-characters-repository.js","components/CharacterStatBlock.jsx","components/ParagraphElementComponentBodyRenderer.jsx","components/ParagraphElementComponent.jsx","components/ShopTableEditor.jsx","components/ShopElementComponent.jsx","components/icons/EditIcon.jsx","components/icons/CopyLinkIcon.jsx","components/ViewElement.jsx","repositories/auth-repository.js","components/icons/UserIcon.jsx","components/icons/LogoutIcon.jsx","components/SessionMenuButton.jsx","components/Navbar.jsx","components/LoginView.jsx","components/LogoutView.jsx","components/UpdatingDBIndicator.jsx","components/SearchBar.jsx","App.jsx","models/database.js","repositories/db-sync-repository.js","repositories/db-repository.js","app-context.js","services/data-corruption-preventer.js","utils/keyboard-shorcuts-handler.js","index.js"],"names":["map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","resolve","module","exports","EXTERNAL_TOOLS","name","url","CreateNarrativeContextIcon","icon","faBook","color","ImportNarrativeContextIcon","faFileImport","IdGenerator","uuidv4","ArrayUtils","arr","old_index","new_index","length","k","push","undefined","splice","BaseElement","type","this","generateId","data","TYPES","PARAGRAPH","CONTAINER","SHOP","ParagraphElement","body","json","ContainerElement","elements","elementId","find","x","element","getElement","indexOf","oldIndex","newIndex","moveElementInArray","findInChild","found","plainElements","concat","getPlainViewableElements","toJson","ElementsFactory","mapElementFromJson","ShopItem","title","price","link","amount","fromJson","instance","ShopElement","items","_ELEMENT_TYPES_MAPPING","paragraph","container","shop","NarrativeCategory","viewableElements","index","NarrativeContext","categories","categoryId","category","getNarrativeCategory","term","cleanStr","str","toLowerCase","normalize","replace","filter","includes","findElementAnywhere","NarrativeContextImporter","narrativeContextJson","appContext","narrativeContext","JSON","parse","alert","getDB","getNarrativeContext","addNarrativeContext","saveDB","Home","navigate","useNavigate","useState","campaigns","setCampaigns","worlds","setWorlds","useEffect","setNarrativeContextById","setBackButtonUrl","setForwardButtonUrl","db","importNarrativeContext","a","preventDefault","reader","FileReader","onload","target","result","importFromJson","setTimeout","document","getElementById","value","readAsText","files","className","onClick","hidden","onChange","accept","click","role","aria-label","key","to","href","CreateNarrativeContext","setName","setType","placeholder","event","CreateIcon","faPlus","ScrollIcon","faScroll","FolderIcon","faFolderOpen","ShopIcon","faShoppingCart","CreateElementButton","dropdownBody","useRef","onDropdownElementClick","current","classList","toggle","ref","RenameIcon","faTag","MoveUpIcon","faLevelUpAlt","MoveDownIcon","faLevelDownAlt","DeleteIcon","faTrashAlt","CollapseIcon","faAngleDown","ExpandIcon","faChevronRight","ElementListItem","narrativeContextId","narrativeCategoryId","onMoveElementUp","onMoveElementDown","onDeleteElement","onRenameElement","onChildUpdate","tabElement","highlight","setHighlight","elementListItemExpandedStatuses","expanded","setExpanded","isContainer","deleteChildElement","childElement","window","confirm","removeElement","moveChildElementUp","moveElementUp","moveChildElementDown","moveElementDown","renameChildElement","prompt","onMouseEnter","onMouseLeave","icons","getIcon","newElement","createElement","addElement","NarrativeCategoryComponent","narrativeCategory","onCategoryChange","moveCategoryUp","moveCategoryDown","elementsState","setElementsState","rerender","deleteElement","renameElement","removeNarrativeCategory","ExportNarrativeContextIcon","faFileDownload","ViewNarrativeContext","useParams","setNarrativeContext","narrativeContextCategories","setNarrativeContextCategories","obtainedNarrativeContext","moveNarrativeCategoryUp","moveNarrativeCategoryDown","categoryName","addNarrativeCategory","narrativeContextDownloadLink","content","stringify","file","Blob","URL","createObjectURL","download","removeNarrativeContext","RichTextEditor","initialValue","editor","currentChangeId","handleInput","changeId","getContents","lang","defaultValue","height","innerHeight","documentElement","clientHeight","getEditorHeight","state","onInput","getSunEditorInstance","sunEditor","setOptions","buttonList","formats","tag","WEB_API_URL","location","origin","WebApiRepository","localStorage","getItem","endpoint","headers","authToken","_get_token","fetch","method","response","ok","stringBody","Pako","gzip","DnD5eCharactersRepository","characterId","_characters","_get","CharacterStatBlock","character","character_id","class","race","alignment","armor_class","max_hp","speed","proficiency_bonus","ability_scores","ability_score","toUpperCase","substring","modifier","saving_throws","saving_throw","has_proficiency","join","skills","skill","passive_perception","get_senses","languages","spellcasting","spellcasting_ability","saving_throws_cd","attack_bonus","spell_levels","parseInt","spell_level","max_spell_slots","spells","ParagraphElementComponentBodyRenderer","renderedBody","setRenderedBody","htmlBody","renderBody","getCharacter","repo","getRepository","innerHTML","ReactDOMServer","renderToString","replaceCharacters","html","matches","matchAll","replaced_body","match","dangerouslySetInnerHTML","__html","ParagraphElementComponent","parentExposedFuntions","editMode","setEditMode","currentEditorValue","hasChangedAtLeastOneTime","discardChanges","edit","saveDBAsync","ShopTableEditor","onItemsChange","clone","itemsList","setItemsList","updateItemProp","item","prop","addItem","ShopElementComponent","currentEditorItems","childFunctions","EditIcon","faEdit","CopyLinkIcon","faLink","ViewElement","setElement","childFuntions","obtainedElement","prevElement","getPrevElement","nextElement","getNextElement","setNavigationButtons","relLink","navigator","clipboard","writeText","onDelete","AuthRepository","onLogin","onLogout","credentials","_post","setItem","token","username","removeItem","UserIcon","faUser","LogoutIcon","faSignOutAlt","SessionMenuButton","logout","Navbar","backButtonUrl","forwardButtonUrl","_setNarrativeContextById","navigateToPreviousElement","navigateToNextElement","faDiceD20","faAngleLeft","faAngleRight","isAuthenticated","LoginView","setUsername","password","setPassword","login","onSubmit","autoCorrect","autoCapitalize","LogoutView","UpdatingDBIndicator","faCloudUploadAlt","_searchResults","_resultIndex","SearchBar","searchResults","setSearchResults","resultIndex","setResultIndex","generateElementLink","getNarrativeContextId","getNarrativeCategoryByElementId","moveIndex","scrollToSeletedResult","hideSearchBar","scrollIntoView","addEventListener","search","removeEventListener","searchTerm","autoFocus","i","App","authRepo","userLogged","updatingDB","setUpdatingDB","searchBarDisplayed","setSearchBarDisplayed","setUpdatingDBIndicator","showSearchBar","path","Database","addWorld","addCampaign","narrativeContextsList","world","campaign","DBSyncRepository","dbJson","DBRepository","_db","_tryDownloadCloudDB","hook","_onCloudDBDownloadedHooks","_afterSaveHooks","callback","_onDirtyDBCallback","_preventSave","_save","console","log","_dbSyncRepository","pullDB","downloadedDB","pushDB","_callAfterSaveHooks","_DB_KEY","AppContext","_repositories","_narrativeContextId","status","repositoryClass","eventName","DataCorruptionPreventer","_appContext","_interval","_INTERVAL_TIME","_lastDBSaveTime","_LAST_SAVE_DATE_KEY","_getStoredDate","_registerAfterSaveHook","_registerOnDirtyDBCallback","registerAfterSaveHook","_updateLastSaveInfo","registerOnDirtyDBCallback","_onDirtyDB","saveDate","Date","toString","lastSaveDateStr","storedDate","setInterval","_isWorkingDirty","enableSavingPrevention","clearInterval","reload","KeyboardShortcutsHandler","_pressedKeys","_tryRemovePressedKey","_addPressedKey","_keyPressed","triggerEvent","dataCorruptionPreventer","keyboardShortcutsHandler","dbRepo","start","tryGetCloudDB","registerKeyboardShortcuts","ReactDom","render"],"mappings":"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","file":"static/js/main.3072a376.chunk.js","sourcesContent":["var map = {\n\t\"./ckb.js\": 25,\n\t\"./da.js\": 26,\n\t\"./de.js\": 27,\n\t\"./en.js\": 18,\n\t\"./es.js\": 28,\n\t\"./fr.js\": 29,\n\t\"./he.js\": 30,\n\t\"./index.js\": 77,\n\t\"./it.js\": 31,\n\t\"./ja.js\": 32,\n\t\"./ko.js\": 33,\n\t\"./lv.js\": 34,\n\t\"./nl.js\": 35,\n\t\"./pl.js\": 36,\n\t\"./pt_br.js\": 37,\n\t\"./ro.js\": 38,\n\t\"./ru.js\": 39,\n\t\"./se.js\": 40,\n\t\"./ua.js\": 41,\n\t\"./zh_cn.js\": 42\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 76;","export const EXTERNAL_TOOLS = [\n    {\n        name: '5etools',\n        url: 'https://5e.tools/',\n    },\n    {\n        name: 'Generador de bloque de estadísticas',\n        url: 'https://gabrielmartinmoran.github.io/DnD5eAbilityScoresGenerator/',\n    },\n    {\n        name: 'Calculadora de encuentros',\n        url: 'https://kastark.co.uk/rpgs/encounter-calculator-5th/',\n    },\n    {\n        name: 'Generador de nombres (Fantasy Name Generator)',\n        url: 'https://www.fantasynamegen.com/',\n    },\n    {\n        name: 'Razas (D&D Beyond)',\n        url: 'https://www.dndbeyond.com/races',\n    },\n    {\n        name: 'Clases (D&D Beyond)',\n        url: 'https://www.dndbeyond.com/classes',\n    },\n    {\n        name: 'Generador de tokens (Token Samp 2)',\n        url: 'https://rolladvantage.com/tokenstamp/',\n    },\n];\n","import React from 'react';\nimport { faBook } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\n\nexport function CreateNarrativeContextIcon() {\n    return <FontAwesomeIcon icon={faBook} color={'#72b52f'} />\n}","import React from 'react';\nimport { faFileImport } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\n\nexport function ImportNarrativeContextIcon() {\n    return <FontAwesomeIcon icon={faFileImport} color={'#6942f5'} />\n}","import { v4 as uuidv4 } from 'uuid';\n\nexport class IdGenerator {\n    static generateId() {\n        return uuidv4();\n    }\n}\n","export class ArrayUtils {\n    static moveElementInArray(arr, old_index, new_index) {\n        if (new_index >= arr.length) {\n            var k = new_index - arr.length + 1;\n            while (k--) {\n                arr.push(undefined);\n            }\n        }\n        arr.splice(new_index, 0, arr.splice(old_index, 1)[0]);\n    }\n}\n","import { IdGenerator } from '../utils/id-generator';\n\nexport class BaseElement {\n    id = null;\n    name = null;\n    type = null;\n\n    static TYPES = {\n        PARAGRAPH: 'paragraph',\n        CONTAINER: 'container',\n        SHOP: 'shop',\n    };\n\n    constructor(name, type) {\n        this.id = IdGenerator.generateId();\n        this.name = name;\n        this.type = type;\n    }\n\n    toJson() {\n        return {\n            id: this.id,\n            name: this.name,\n            type: this.type,\n        };\n    }\n\n    static fromJson(data) {\n        throw Error('This method should not be used!');\n    }\n}\n","import { BaseElement } from './base-element';\n\nexport class ParagraphElement extends BaseElement {\n    body = null;\n\n    constructor(name, body = null) {\n        super(name, BaseElement.TYPES.PARAGRAPH);\n        this.body = body;\n    }\n\n    toJson() {\n        const json = super.toJson();\n        json['body'] = this.body;\n        return json;\n    }\n\n    static fromJson(data) {\n        const instance = new ParagraphElement(data['name'], data['body']);\n        return instance;\n    }\n}\n","import { BaseElement } from './base-element';\nimport { ElementsFactory } from '../utils/elements-factory';\nimport { ArrayUtils } from '../utils/array-utils';\n\nexport class ContainerElement extends BaseElement {\n    elements = null;\n\n    constructor(name, elements = []) {\n        super(name, BaseElement.TYPES.CONTAINER);\n        this.elements = elements;\n    }\n\n    getElement(elementId) {\n        return this.elements.find((x) => x.id === elementId);\n    }\n\n    addElement(element) {\n        this.elements.push(element);\n    }\n\n    removeElement(elementId) {\n        const element = this.getElement(elementId);\n        this.elements.splice(this.elements.indexOf(element), 1);\n    }\n\n    moveElementUp(elementId) {\n        const oldIndex = this.elements.indexOf(this.elements.find((x) => x.id === elementId));\n        const newIndex = oldIndex - 1;\n        if (oldIndex === 0) return;\n        ArrayUtils.moveElementInArray(this.elements, oldIndex, newIndex);\n    }\n\n    moveElementDown(elementId) {\n        const oldIndex = this.elements.indexOf(this.elements.find((x) => x.id === elementId));\n        const newIndex = oldIndex + 1;\n        if (newIndex === this.elements.length) return;\n        ArrayUtils.moveElementInArray(this.elements, oldIndex, newIndex);\n    }\n\n    findInChild(elementId) {\n        for (const element of this.elements) {\n            if (element.id === elementId) return element;\n            if (element.findInChild) {\n                const found = element.findInChild(elementId);\n                if (found) return found;\n            }\n        }\n        return null;\n    }\n\n    // Returns a plain list of viewable elements obtained through iteraring al childs\n    getPlainViewableElements() {\n        let plainElements = [];\n        for (const element of this.elements) {\n            if (element.type === BaseElement.TYPES.CONTAINER) {\n                plainElements = plainElements.concat(element.getPlainViewableElements());\n            } else {\n                plainElements.push(element);\n            }\n        }\n        return plainElements;\n    }\n\n    toJson() {\n        const json = super.toJson();\n        json['elements'] = this.elements.map((x) => x.toJson());\n        return json;\n    }\n\n    static fromJson(data) {\n        const instance = new ContainerElement(\n            data['name'],\n            (data['elements'] || []).map((x) => ElementsFactory.mapElementFromJson(x))\n        );\n        return instance;\n    }\n}\n","import { IdGenerator } from '../utils/id-generator';\n\nexport class ShopItem {\n    id = null;\n    title = null;\n    price = null;\n    link = null;\n    amount = 0;\n\n    constructor(title, price, link, amount = 0) {\n        this.id = IdGenerator.generateId();\n        this.title = title;\n        this.price = price;\n        this.link = link;\n        this.amount = amount;\n    }\n\n    clone() {\n        return ShopItem.fromJson(this.toJson());\n    }\n\n    toJson() {\n        return {\n            id: this.id,\n            title: this.title,\n            price: this.price,\n            link: this.link,\n            amount: this.amount,\n        };\n    }\n\n    static fromJson(data) {\n        const instance = new ShopItem(data['title'], data['price'], data['link'], data['amount']);\n        instance.id = data['id'];\n        return instance;\n    }\n}\n","import { BaseElement } from './base-element';\nimport { ShopItem } from './shop-item';\n\nexport class ShopElement extends BaseElement {\n    items = null;\n\n    constructor(name, items = []) {\n        super(name, BaseElement.TYPES.SHOP);\n        this.items = items;\n    }\n\n    toJson() {\n        const json = super.toJson();\n        json['items'] = this.items.map((x) => x.toJson());\n        return json;\n    }\n\n    static fromJson(data) {\n        const instance = new ShopElement(\n            data['name'],\n            data['items'].map((x) => ShopItem.fromJson(x))\n        );\n        return instance;\n    }\n}\n","import { ParagraphElement } from '../models/paragraph-element';\nimport { ContainerElement } from '../models/container-element';\nimport { ShopElement } from '../models/shop-element';\n\nexport class ElementsFactory {\n    static _ELEMENT_TYPES_MAPPING = {\n        paragraph: ParagraphElement,\n        container: ContainerElement,\n        shop: ShopElement,\n    };\n\n    static mapElementFromJson(data) {\n        const instance = this._ELEMENT_TYPES_MAPPING[data['type']].fromJson(data);\n        instance.id = data['id'];\n        return instance;\n    }\n\n    static createElement(name, type) {\n        return new this._ELEMENT_TYPES_MAPPING[type](name);\n    }\n}\n","import { IdGenerator } from '../utils/id-generator';\nimport { ArrayUtils } from '../utils/array-utils';\nimport { ElementsFactory } from '../utils/elements-factory';\nimport { BaseElement } from './base-element';\n\nexport class NarrativeCategory {\n    id = null;\n    type = null;\n    elements = null;\n\n    constructor(name) {\n        this.id = IdGenerator.generateId();\n        this.name = name;\n        this.elements = [];\n    }\n\n    getElement(elementId) {\n        return this.elements.find((x) => x.id === elementId);\n    }\n\n    findElementAnywhere(elementId) {\n        for (const element of this.elements) {\n            if (element.id === elementId) return element;\n            if (element.findInChild) {\n                const found = element.findInChild(elementId);\n                if (found) return found;\n            }\n        }\n        return null;\n    }\n\n    addElement(element) {\n        this.elements.push(element);\n    }\n\n    removeElement(elementId) {\n        const element = this.getElement(elementId);\n        this.elements.splice(this.elements.indexOf(element), 1);\n    }\n\n    moveElementUp(elementId) {\n        const oldIndex = this.elements.indexOf(this.elements.find((x) => x.id === elementId));\n        const newIndex = oldIndex - 1;\n        if (oldIndex === 0) return;\n        ArrayUtils.moveElementInArray(this.elements, oldIndex, newIndex);\n    }\n\n    moveElementDown(elementId) {\n        const oldIndex = this.elements.indexOf(this.elements.find((x) => x.id === elementId));\n        const newIndex = oldIndex + 1;\n        if (newIndex === this.elements.length) return;\n        ArrayUtils.moveElementInArray(this.elements, oldIndex, newIndex);\n    }\n\n    // Returns a plain list of viewable elements obtained through iteraring al childs\n    getPlainViewableElements() {\n        let plainElements = [];\n        for (const element of this.elements) {\n            if (element.type === BaseElement.TYPES.CONTAINER) {\n                plainElements = plainElements.concat(element.getPlainViewableElements());\n            } else {\n                plainElements.push(element);\n            }\n        }\n        return plainElements;\n    }\n\n    getPrevElement(elementId) {\n        const viewableElements = this.getPlainViewableElements();\n        const index = viewableElements.indexOf(viewableElements.find((x) => x.id === elementId));\n        if (index === 0) return null;\n        return viewableElements[index - 1];\n    }\n\n    getNextElement(elementId) {\n        const viewableElements = this.getPlainViewableElements();\n        const index = viewableElements.indexOf(viewableElements.find((x) => x.id === elementId));\n        if (index === viewableElements.length - 1) return null;\n        return viewableElements[index + 1];\n    }\n\n    toJson() {\n        return {\n            id: this.id,\n            name: this.name,\n            elements: this.elements.map((element) => element.toJson()),\n        };\n    }\n\n    static fromJson(data) {\n        const instance = new NarrativeCategory(data['name']);\n        instance.id = data['id'];\n        instance.elements = data['elements'].map((x) => ElementsFactory.mapElementFromJson(x));\n        return instance;\n    }\n}\n","import { IdGenerator } from '../utils/id-generator';\nimport { NarrativeCategory } from './narrative-category';\nimport { ArrayUtils } from '../utils/array-utils';\nimport { createEditorStateWithText } from '@draft-js-plugins/editor';\n\nexport class NarrativeContext {\n    static TYPES = [\n        { type: 'world', name: 'Mundo' },\n        { type: 'campaign', name: 'Campaña' },\n    ];\n\n    id = null;\n    type = null;\n    name = null;\n    categories = null;\n\n    constructor(type, name) {\n        if (!NarrativeContext.TYPES.find((x) => x.type === type)) throw Error('Invalid type');\n        this.id = IdGenerator.generateId();\n        this.type = type;\n        this.name = name;\n        this.categories = [];\n    }\n\n    getNarrativeCategory(categoryId) {\n        return this.categories.find((x) => x.id === categoryId);\n    }\n\n    addNarrativeCategory(category) {\n        this.categories.push(category);\n    }\n\n    removeNarrativeCategory(categoryId) {\n        const category = this.getNarrativeCategory(categoryId);\n        this.categories.splice(this.categories.indexOf(category), 1);\n    }\n\n    moveNarrativeCategoryUp(categoryId) {\n        const oldIndex = this.categories.indexOf(this.categories.find((x) => x.id === categoryId));\n        const newIndex = oldIndex - 1;\n        if (oldIndex === 0) return;\n        ArrayUtils.moveElementInArray(this.categories, oldIndex, newIndex);\n    }\n\n    moveNarrativeCategoryDown(categoryId) {\n        const oldIndex = this.categories.indexOf(this.categories.find((x) => x.id === categoryId));\n        const newIndex = oldIndex + 1;\n        if (newIndex === this.categories.length) return;\n        ArrayUtils.moveElementInArray(this.categories, oldIndex, newIndex);\n    }\n\n    searchTerm(term) {\n        let elements = [];\n        for (const category of this.categories) {\n            elements = elements.concat(category.getPlainViewableElements());\n        }\n        const cleanStr = (str) => {\n            return str\n                .toLowerCase()\n                .normalize('NFD')\n                .replace(/[\\u0300-\\u036f]/g, '');\n        };\n        return elements.filter((element) => cleanStr(element.name).includes(cleanStr(term)));\n    }\n\n    getNarrativeCategoryByElementId(elementId) {\n        for (const category of this.categories) {\n            if (category.findElementAnywhere(elementId)) {\n                return category;\n            }\n        }\n        return null;\n    }\n\n    toJson() {\n        return {\n            id: this.id,\n            type: this.type,\n            name: this.name,\n            categories: this.categories.map((x) => x.toJson()),\n        };\n    }\n\n    static fromJson(data) {\n        const instance = new NarrativeContext(data['type'], data['name']);\n        instance.id = data['id'];\n        instance.categories = data['categories'].map((x) => NarrativeCategory.fromJson(x));\n        return instance;\n    }\n}\n","import { NarrativeContext } from '../models/narrative-context';\nexport class NarrativeContextImporter {\n    static importFromJson(narrativeContextJson, appContext) {\n        let narrativeContext = null;\n        try {\n            narrativeContext = NarrativeContext.fromJson(JSON.parse(narrativeContextJson));\n        } catch {\n            alert(\n                'Ha ocurrido un error al importar el contexto narrativo. El formato del archivo no parece ser válido!'\n            );\n            return;\n        }\n\n        const foundExistentNarrativeContext = appContext.getDB().getNarrativeContext(narrativeContext.id);\n        if (foundExistentNarrativeContext) {\n            alert(\n                'Ha ocurrido un error al importar el contexto narrativo. Parece ser que posees otro contexto narrativo con el mismo identificador!'\n            );\n            return;\n        }\n        appContext.getDB().addNarrativeContext(narrativeContext);\n        alert('La importación fue realizada con éxito!');\n        appContext.saveDB();\n    }\n}\n","import '../styles/Home.css';\nimport React, { useEffect, useState } from 'react';\nimport { Link, useNavigate } from 'react-router-dom';\nimport { EXTERNAL_TOOLS } from '../data/external-tools';\nimport { CreateNarrativeContextIcon } from './icons/CreateNarrativeContextIcon';\nimport { ImportNarrativeContextIcon } from './icons/ImportNarrativeContextIcon';\nimport { NarrativeContextImporter } from '../utils/narrative-context-importer';\n\nexport function Home({ appContext }) {\n    const navigate = useNavigate();\n\n    const [campaigns, setCampaigns] = useState([]);\n    const [worlds, setWorlds] = useState([]);\n\n    useEffect(() => {\n        appContext.setNarrativeContextById(null);\n        appContext.setBackButtonUrl(null);\n        appContext.setForwardButtonUrl(null);\n        const db = appContext.getDB();\n        setCampaigns(db.campaigns);\n        setWorlds(db.worlds);\n    }, [appContext]);\n\n    const createElementDB = () => {\n        navigate('/create-narrative-context');\n    };\n\n    const importNarrativeContext = async (e) => {\n        e.preventDefault();\n        const reader = new FileReader();\n        reader.onload = async (e) => {\n            const json = e.target.result;\n            NarrativeContextImporter.importFromJson(json, appContext);\n            const db = appContext.getDB();\n            setCampaigns([...db.campaigns]);\n            setWorlds([...db.worlds]);\n            setTimeout(() => {\n                setCampaigns(db.campaigns);\n                setWorlds(db.worlds);\n            }, 0);\n            document.getElementById('narrativeContextFileSelector').value = null;\n        };\n        reader.readAsText(e.target.files[0]);\n    };\n\n    return (\n        <div>\n            <div className=\"homeTitleSection\">\n                <h1 className=\"flex1\">Contextos narrativos</h1>\n                <div className=\"homeTitleButtons\">\n                    <button onClick={createElementDB}>\n                        <CreateNarrativeContextIcon /> Crear\n                    </button>\n                    <input\n                        type=\"file\"\n                        id=\"narrativeContextFileSelector\"\n                        hidden={true}\n                        onChange={importNarrativeContext}\n                        accept=\"application/json\"\n                    />\n                    <button onClick={() => document.getElementById('narrativeContextFileSelector').click()}>\n                        <ImportNarrativeContextIcon /> Importar\n                    </button>\n                </div>\n            </div>\n\n            <h2>\n                <span role=\"img\" aria-label=\"books\">\n                    📚\n                </span>{' '}\n                Campañas\n            </h2>\n            <ul>\n                {campaigns.map((x) => (\n                    <li key={x.id}>\n                        <Link to={`/narrative-context/${x.id}`}>{x.name}</Link>\n                    </li>\n                ))}\n            </ul>\n            <h2>\n                <span role=\"img\" aria-label=\"world\">\n                    🌎\n                </span>{' '}\n                Mundos\n            </h2>\n            <ul>\n                {worlds.map((x) => (\n                    <li key={x.id}>\n                        <Link to={`/narrative-context/${x.id}`}>{x.name}</Link>\n                    </li>\n                ))}\n            </ul>\n            <h2>\n                <span role=\"img\" aria-label=\"tools\">\n                    ⚒️\n                </span>{' '}\n                Herramientas\n            </h2>\n            <ul>\n                {EXTERNAL_TOOLS.map((x) => (\n                    <li key={x.name}>\n                        <a href={x.url}>{x.name}</a>\n                    </li>\n                ))}\n            </ul>\n        </div>\n    );\n}\n","import React, { useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { NarrativeContext } from '../models/narrative-context';\n\nexport function CreateNarrativeContext({ appContext }) {\n    const navigate = useNavigate();\n\n    const [name, setName] = useState();\n    const [type, setType] = useState(NarrativeContext.TYPES[0].type);\n\n    useEffect(() => {\n        appContext.setNarrativeContextById(null);\n    }, [appContext]);\n\n    const create = () => {\n        const narrativeContext = new NarrativeContext(type, name);\n        appContext.getDB().addNarrativeContext(narrativeContext);\n        appContext.saveDB();\n        navigate('/');\n    };\n\n    return (\n        <div>\n            <h1>Crear contexto narrativo</h1>\n            <input type=\"text\" placeholder=\"Nombre\" onChange={(event) => setName(event.target.value)} />\n            <select onChange={(event) => setType(event.target.value)}>\n                {NarrativeContext.TYPES.map((x) => (\n                    <option key={x.type} value={x.type}>\n                        {x.name}\n                    </option>\n                ))}\n            </select>\n            <button onClick={create}>Crear</button>\n        </div>\n    );\n}\n","import React from 'react';\nimport { faPlus } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\n\nexport function CreateIcon() {\n    return <FontAwesomeIcon icon={faPlus} color={'#2b3340'} />\n}","import React from 'react';\nimport { faScroll } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\n\nexport function ScrollIcon() {\n    return <FontAwesomeIcon icon={faScroll} color={'#baa28f'} />\n}","import React from 'react';\nimport { faFolderOpen } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\n\nexport function FolderIcon() {\n    return <FontAwesomeIcon icon={faFolderOpen} color={'#FACC30'} />\n}","import React from 'react';\nimport { faShoppingCart } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\n\nexport function ShopIcon() {\n    return <FontAwesomeIcon icon={faShoppingCart} color={'#609fbf'} />\n}","import '../styles/CreateElementButton.css';\nimport React, { useRef } from 'react';\nimport { BaseElement } from '../models/base-element';\nimport { CreateIcon } from './icons/CreateIcon';\nimport { ScrollIcon } from './icons/ScrollIcon';\nimport { FolderIcon } from './icons/FolderIcon';\nimport { ShopIcon } from './icons/ShopIcon';\n\nexport function CreateElementButton({ onClick = (type) => {} }) {\n    const dropdownBody = useRef();\n\n    const showDropdown = () => {\n        dropdownBody.current.classList.toggle('showDropdownBody');\n    };\n\n    const onDropdownElementClick = (type) => {\n        dropdownBody.current.classList.toggle('showDropdownBody');\n        onClick(type);\n    };\n\n    return (\n        <div className=\"CreateElementButton\">\n            <button onClick={showDropdown}>\n                <CreateIcon />\n                <span className=\"tooltip\">Crear elemento</span>\n            </button>\n            <div ref={dropdownBody} className=\"dropdownBody\">\n                <button onClick={() => onDropdownElementClick(BaseElement.TYPES.PARAGRAPH)}>\n                    <ScrollIcon /> Texto\n                </button>\n                <button onClick={() => onDropdownElementClick(BaseElement.TYPES.CONTAINER)}>\n                    <FolderIcon /> Contenedor\n                </button>\n                <button onClick={() => onDropdownElementClick(BaseElement.TYPES.SHOP)}>\n                    <ShopIcon /> Tienda\n                </button>\n            </div>\n        </div>\n    );\n}\n","import React from 'react';\nimport { faTag } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\n\nexport function RenameIcon() {\n    return <FontAwesomeIcon icon={faTag} color={'#fcba03'} />\n}","import React from 'react';\nimport { faLevelUpAlt } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\n\nexport function MoveUpIcon() {\n    return <FontAwesomeIcon icon={faLevelUpAlt} color={'#012452'} />\n}","import React from 'react';\nimport { faLevelDownAlt } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\n\nexport function MoveDownIcon() {\n    return <FontAwesomeIcon icon={faLevelDownAlt} color={'#012452'} />\n}","import React from 'react';\nimport { faTrashAlt } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\n\nexport function DeleteIcon() {\n    return <FontAwesomeIcon icon={faTrashAlt} color={'#98a3b3'} />\n}","import React from 'react';\nimport { faAngleDown } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\n\nexport function CollapseIcon() {\n    return <FontAwesomeIcon icon={faAngleDown} color={'#424242'}/>\n}","import React from 'react';\nimport { faChevronRight } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\n\nexport function ExpandIcon() {\n    return <FontAwesomeIcon icon={faChevronRight} color={'#424242'} />\n}","import '../styles/ElementListItem.css';\nimport React, { useState } from 'react';\nimport { BaseElement } from '../models/base-element';\nimport { Link } from 'react-router-dom';\nimport { ElementsFactory } from '../utils/elements-factory';\nimport { CreateElementButton } from './CreateElementButton';\nimport { RenameIcon } from './icons/RenameIcon';\nimport { MoveUpIcon } from './icons/MoveUpIcon';\nimport { MoveDownIcon } from './icons/MoveDownIcon';\nimport { DeleteIcon } from './icons/DeleteIcon';\nimport { ScrollIcon } from './icons/ScrollIcon';\nimport { FolderIcon } from './icons/FolderIcon';\nimport { ShopIcon } from './icons/ShopIcon';\nimport { CollapseIcon } from './icons/CollapseIcon';\nimport { ExpandIcon } from './icons/ExpandIcon';\n\nexport function ElementListItem({\n    appContext,\n    narrativeContextId,\n    narrativeCategoryId,\n    element,\n    onMoveElementUp = (element) => {},\n    onMoveElementDown = (element) => {},\n    onDeleteElement = (element) => {},\n    onRenameElement = (element) => {},\n    onChildUpdate = () => {},\n    tabElement = false,\n}) {\n    const [highlight, setHighlight] = useState(false);\n    const [expanded, setExpanded] = useState(appContext.elementListItemExpandedStatuses[element.id] || false);\n\n    const isContainer = () => {\n        return element.type === BaseElement.TYPES.CONTAINER;\n    };\n\n    const shouldDisplayLink = () => {\n        return !isContainer();\n    };\n\n    const getIcon = () => {\n        const icons = {};\n        icons[BaseElement.TYPES.PARAGRAPH] = <ScrollIcon />;\n        icons[BaseElement.TYPES.CONTAINER] = <FolderIcon />;\n        icons[BaseElement.TYPES.SHOP] = <ShopIcon />;\n        return icons[element.type];\n    };\n\n    const createChildElement = (type) => {\n        const name = window.prompt('Ingresa el nombre del nuevo elemento');\n        if (!name) return;\n        const newElement = ElementsFactory.createElement(name, type);\n        element.addElement(newElement);\n        appContext.saveDB();\n        onChildUpdate();\n    };\n\n    const deleteChildElement = (childElement) => {\n        const shouldDelete = window.confirm(`Estas seguro de eliminar el elemento ${childElement.name}`);\n        if (!shouldDelete) return;\n        element.removeElement(childElement.id);\n        appContext.saveDB();\n        onChildUpdate();\n    };\n\n    const moveChildElementUp = (childElement) => {\n        element.moveElementUp(childElement.id);\n        appContext.saveDB();\n        onChildUpdate();\n    };\n\n    const moveChildElementDown = (childElement) => {\n        element.moveElementDown(childElement.id);\n        appContext.saveDB();\n        onChildUpdate();\n    };\n\n    const renameChildElement = (element) => {\n        const name = window.prompt('Ingresa el nuevo nombre del elemento', element.name);\n        if (!name) return;\n        element.name = name;\n        appContext.saveDB();\n        onChildUpdate();\n    };\n\n    const highlightElement = () => {\n        setHighlight(true);\n    };\n\n    const unhighlightElement = () => {\n        setHighlight(false);\n    };\n\n    const toggleExpand = () => {\n        setExpanded(!expanded);\n        // To store the expanded status while navigating through the app\n        appContext.elementListItemExpandedStatuses[element.id] = !expanded;\n    };\n\n    return (\n        <div\n            className={tabElement ? 'listItemTabbed' : ''}\n            onMouseEnter={highlightElement}\n            onMouseLeave={unhighlightElement}\n        >\n            <div className={'flex ' + (highlight ? 'highlightedListItem' : '')}>\n                {isContainer() ? (\n                    <button className=\"collapseExpandButton\" onClick={() => toggleExpand()}>\n                        {expanded ? <CollapseIcon /> : <ExpandIcon />}\n                    </button>\n                ) : (\n                    <></>\n                )}\n                <div className={'flex2 elementListItemName '}>\n                    <span role=\"img\" aria-label=\"icon\">\n                        {getIcon()}{' '}\n                    </span>\n                    {shouldDisplayLink() ? (\n                        <Link to={`/narrative-context/${narrativeContextId}/${narrativeCategoryId}/${element.id}`}>\n                            {element.name}\n                        </Link>\n                    ) : (\n                        <span>{element.name}</span>\n                    )}\n                </div>\n\n                <div className=\"textRight\">\n                    {isContainer() ? <CreateElementButton onClick={createChildElement} /> : <></>}\n                    <button onClick={() => onRenameElement(element)}>\n                        <RenameIcon />\n                        <span className=\"tooltip\">Renombrar</span>\n                    </button>\n                    <button onClick={() => onMoveElementUp(element)}>\n                        <MoveUpIcon />\n                        <span className=\"tooltip\">Subir</span>\n                    </button>\n                    <button onClick={() => onMoveElementDown(element)}>\n                        <MoveDownIcon />\n                        <span className=\"tooltip\">Bajar</span>\n                    </button>\n                    <button onClick={() => onDeleteElement(element)}>\n                        <DeleteIcon />\n                        <span className=\"tooltip\">Eliminar</span>\n                    </button>\n                </div>\n            </div>\n            {isContainer() ? (\n                <div>\n                    {expanded ? (\n                        element.elements.map((childElement) => (\n                            <ElementListItem\n                                key={childElement.id}\n                                appContext={appContext}\n                                narrativeContextId={narrativeContextId}\n                                narrativeCategoryId={narrativeCategoryId}\n                                element={childElement}\n                                onMoveElementUp={moveChildElementUp}\n                                onMoveElementDown={moveChildElementDown}\n                                onDeleteElement={deleteChildElement}\n                                onRenameElement={renameChildElement}\n                                onChildUpdate={onChildUpdate}\n                                tabElement={true}\n                            />\n                        ))\n                    ) : (\n                        <></>\n                    )}\n                </div>\n            ) : (\n                <></>\n            )}\n        </div>\n    );\n}\n","import '../styles/NarrativeCategoryComponent.css';\nimport React, { useState } from 'react';\nimport { CreateElementButton } from './CreateElementButton';\nimport { ElementsFactory } from '../utils/elements-factory';\nimport { ElementListItem } from './ElementListItem';\nimport { RenameIcon } from './icons/RenameIcon';\nimport { MoveUpIcon } from './icons/MoveUpIcon';\nimport { MoveDownIcon } from './icons/MoveDownIcon';\nimport { DeleteIcon } from './icons/DeleteIcon';\n\nexport function NarrativeCategoryComponent({\n    appContext,\n    narrativeContext,\n    narrativeCategory,\n    onCategoryChange,\n    moveCategoryUp,\n    moveCategoryDown,\n}) {\n    const [elementsState, setElementsState] = useState(narrativeCategory.elements);\n\n    const rerender = () => {\n        setElementsState([...narrativeCategory.elements]);\n        setTimeout(() => setElementsState(narrativeCategory.elements), 0);\n    };\n\n    const onCreateElement = (type) => {\n        const name = window.prompt('Ingresa el nombre del nuevo elemento');\n        if (!name) return;\n        const newElement = ElementsFactory.createElement(name, type);\n        narrativeCategory.addElement(newElement);\n        appContext.saveDB();\n        rerender();\n    };\n\n    const deleteElement = (element) => {\n        const shouldDelete = window.confirm(`Estas seguro de eliminar el elemento ${element.name}`);\n        if (!shouldDelete) return;\n        narrativeCategory.removeElement(element.id);\n        appContext.saveDB();\n        rerender();\n    };\n\n    const moveElementUp = (element) => {\n        narrativeCategory.moveElementUp(element.id);\n        appContext.saveDB();\n        rerender();\n    };\n\n    const moveElementDown = (element) => {\n        narrativeCategory.moveElementDown(element.id);\n        appContext.saveDB();\n        rerender();\n    };\n\n    const renameElement = (element) => {\n        const name = window.prompt('Ingresa el nuevo nombre del elemento', element.name);\n        if (!name) return;\n        element.name = name;\n        appContext.saveDB();\n        onCategoryChange();\n    };\n\n    const deleteCategory = () => {\n        const shouldDelete = window.confirm(`Estas seguro de eliminar la categoría ${narrativeCategory.name}`);\n        if (!shouldDelete) return;\n        narrativeContext.removeNarrativeCategory(narrativeCategory.id);\n        appContext.saveDB();\n        onCategoryChange();\n    };\n\n    const renameCategory = () => {\n        const name = window.prompt('Ingresa el nuevo nombre de la categoría', narrativeCategory.name);\n        if (!name) return;\n        narrativeCategory.name = name;\n        appContext.saveDB();\n        onCategoryChange();\n    };\n\n    return (\n        <div className=\"NarrativeCategory\">\n            <div className=\"flex\">\n                <h3 className=\"flex2\">{narrativeCategory.name}</h3>\n                <div className=\"textRight narrativeCategoryTitleButtons\">\n                    <CreateElementButton onClick={onCreateElement} />\n                    <button onClick={renameCategory}>\n                        <RenameIcon />\n                        <span className=\"tooltip\">Renombrar</span>\n                    </button>\n                    <button onClick={() => moveCategoryUp(narrativeCategory)}>\n                        <MoveUpIcon />\n                        <span className=\"tooltip\">Subir</span>\n                    </button>\n                    <button onClick={() => moveCategoryDown(narrativeCategory)}>\n                        <MoveDownIcon />\n                        <span className=\"tooltip\">Bajar</span>\n                    </button>\n                    <button onClick={deleteCategory}>\n                        <DeleteIcon />\n                        <span className=\"tooltip\">Eliminar categoría</span>\n                    </button>\n                </div>\n            </div>\n            <div className=\"narrativeCategoryElements\">\n                {elementsState.map((element) => (\n                    <ElementListItem\n                        key={element.id}\n                        appContext={appContext}\n                        narrativeContextId={narrativeContext.id}\n                        narrativeCategoryId={narrativeCategory.id}\n                        element={element}\n                        onMoveElementUp={moveElementUp}\n                        onMoveElementDown={moveElementDown}\n                        onDeleteElement={deleteElement}\n                        onRenameElement={renameElement}\n                        onChildUpdate={rerender}\n                    />\n                ))}\n            </div>\n        </div>\n    );\n}\n","import React from 'react';\nimport { faFileDownload } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\n\nexport function ExportNarrativeContextIcon() {\n    return <FontAwesomeIcon icon={faFileDownload} color={'#6942f5'} />\n}","import '../styles/ViewNarrativeContext.css';\nimport React, { useEffect, useState } from 'react';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport { NarrativeCategory } from '../models/narrative-category';\nimport { NarrativeCategoryComponent } from './NarrativeCategoryComponent';\nimport { CreateIcon } from './icons/CreateIcon';\nimport { RenameIcon } from './icons/RenameIcon';\nimport { DeleteIcon } from './icons/DeleteIcon';\nimport { ExportNarrativeContextIcon } from './icons/ExportNarrativeContextIcon';\nimport { NarrativeContext } from '../models/narrative-context';\n\nexport function ViewNarrativeContext({ appContext }) {\n    const navigate = useNavigate();\n    const { narrativeContextId } = useParams();\n    const [narrativeContext, setNarrativeContext] = useState(null);\n    const [narrativeContextCategories, setNarrativeContextCategories] = useState([]);\n\n    useEffect(() => {\n        appContext.setNarrativeContextById(narrativeContextId);\n        const obtainedNarrativeContext = appContext.getDB().getNarrativeContext(narrativeContextId);\n        setNarrativeContext(obtainedNarrativeContext);\n        setNarrativeContextCategories(obtainedNarrativeContext.categories);\n        appContext.setBackButtonUrl('/');\n        appContext.setForwardButtonUrl(null);\n    }, [appContext, narrativeContextId]);\n\n    const addNarrativeCategory = () => {\n        const categoryName = window.prompt('Ingresa nombre de la categoría');\n        if (categoryName) {\n            const category = new NarrativeCategory(categoryName);\n            const narrativeContext = appContext.getDB().getNarrativeContext(narrativeContextId);\n            narrativeContext.addNarrativeCategory(category);\n            appContext.saveDB();\n            setNarrativeContextCategories([...narrativeContext.categories]);\n        }\n    }\n\n    const deleteNarrativeContext = () => {\n        const shouldDelete = window.confirm(`Estas seguro que deseas eliminar ${narrativeContext.type === 'world' ? 'el mundo' : 'la campaña'\n            } ${narrativeContext.name}`);\n        if (!shouldDelete) return;\n        appContext.getDB().removeNarrativeContext(narrativeContextId);\n        appContext.saveDB();\n        navigate('/');\n    }\n\n    const renameMarrativeContext = () => {\n        const name = window.prompt(`Ingresa el nuevo nombre de ${narrativeContext.type === 'world' ? 'el mundo' : 'la campaña'}`, narrativeContext.name);\n        if (!name) return;\n        narrativeContext.name = name;\n        appContext.saveDB();\n        setNarrativeContext({ ...narrativeContext });\n        appContext.setNarrativeContextById(null);\n        setTimeout(() => {\n            setNarrativeContext(narrativeContext)\n            appContext.setNarrativeContextById(narrativeContextId);\n        }, 0);\n    }\n\n    const onCategoryChange = () => {\n        setNarrativeContextCategories([...narrativeContext.categories]);\n    }\n\n    const moveCategoryUp = (category) => {\n        narrativeContext.moveNarrativeCategoryUp(category.id);\n        appContext.saveDB();\n        setNarrativeContextCategories([...narrativeContext.categories]);\n    }\n\n    const moveCategoryDown = (category) => {\n        narrativeContext.moveNarrativeCategoryDown(category.id);\n        appContext.saveDB();\n        setNarrativeContextCategories([...narrativeContext.categories]);\n    }\n\n    const exportNarrativeContext = () => {\n        const narrativeContextDownloadLink = document.getElementById('narrativeContextDownloadLink');\n        const content = JSON.stringify(narrativeContext.toJson(), null, 2);\n        const file = new Blob([content], { type: 'application/json' });\n        narrativeContextDownloadLink.href = URL.createObjectURL(file);\n        narrativeContextDownloadLink.download = `${NarrativeContext.TYPES.find(x => x.type === narrativeContext.type).name} - ${narrativeContext.name}.json`;\n        narrativeContextDownloadLink.click();\n    }\n\n    return <div className=\"ViewNarrativeContext\">\n        <div className='flex narrativeContextTitleBar'>\n            <h1 className='flex2'>{\n                narrativeContext?.type === 'world' ?\n                    <span role='img' aria-label='world'>🌎</span> :\n                    <span role='img' aria-label='books'>📚</span>\n            } {narrativeContext?.name}</h1>\n            <div className='textRight narrativeContextTitleButtons'>\n                <button onClick={addNarrativeCategory}>\n                    <CreateIcon />\n                    <span className='tooltip'>Crear categoría</span>\n                </button>\n                <button onClick={renameMarrativeContext}>\n                    <RenameIcon />\n                    <span className='tooltip'>Renombrar</span>\n                </button>\n                <a hidden={true} id='narrativeContextDownloadLink' href='/'> </a>\n                <button onClick={exportNarrativeContext}>\n                    <ExportNarrativeContextIcon />\n                    <span className='tooltip'>Exportar</span>\n                </button>\n                <button onClick={deleteNarrativeContext}>\n                    <DeleteIcon />\n                    <span className='tooltip'>Eliminar</span>\n                </button>\n            </div>\n        </div>\n        {\n            narrativeContextCategories.map(category =>\n                <NarrativeCategoryComponent key={category.id} appContext={appContext}\n                    narrativeCategory={category} narrativeContext={narrativeContext}\n                    onCategoryChange={onCategoryChange} moveCategoryUp={moveCategoryUp}\n                    moveCategoryDown={moveCategoryDown} />)\n        }\n    </div>;\n}","import '../styles/RichTextEditor.css';\nimport React, { useRef } from 'react';\nimport SunEditor from 'suneditor-react';\n\nexport function RichTextEditor({ onChange, initialValue }) {\n    const editorOptions = {\n        buttonList: [\n            ['formatBlock', 'bold', 'underline', 'italic', 'strike'],\n            ['fontColor', 'hiliteColor'],\n            ['removeFormat'],\n            ['align', 'horizontalRule', 'list'],\n            ['table', 'link', 'image', 'video', 'audio'],\n            ['fullScreen', 'codeView'],\n        ],\n        formats: [\n            {\n                tag: 'p',\n                name: 'Párrafo',\n            },\n            {\n                tag: 'h1',\n                name: 'Título',\n            },\n            {\n                tag: 'h2',\n                name: 'Subtítulo',\n            },\n            {\n                tag: 'h3',\n                name: 'Sección',\n            },\n            {\n                tag: 'h4',\n                name: 'Subsección',\n            },\n            {\n                tag: 'blockquote',\n                name: 'Bloque de descripción',\n            },\n            {\n                tag: 'pre',\n                name: 'Notas de DM',\n            },\n            //'p', 'blockquote', 'pre', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6'\n        ],\n    };\n\n    const editor = useRef();\n\n    let currentChangeId = 0;\n    const changeUpdateTimeout = 200;\n\n    const getSunEditorInstance = (sunEditor) => {\n        editor.current = sunEditor;\n    };\n\n    const deferredUpdate = (changeId) => {\n        setTimeout(() => {\n            if (changeId === currentChangeId) {\n                // Sometimes the ref does not have getContents function, in that case we skip this deferred update\n                if (!editor.current.getContents) return;\n                onChange(editor.current.getContents());\n            }\n        }, changeUpdateTimeout);\n    };\n\n    const handleInput = () => {\n        currentChangeId += 1;\n        deferredUpdate(currentChangeId);\n    };\n\n    const getEditorHeight = () => {\n        const height = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;\n        if (height <= 640) return '48vh';\n        if (height <= 900) return '67vh';\n        return '73vh';\n    };\n\n    return (\n        <div className=\"EditorContainer\">\n            <SunEditor\n                lang=\"es\"\n                defaultValue={initialValue}\n                height={getEditorHeight()}\n                onChange={(state) => handleInput()}\n                onInput={(event) => handleInput()}\n                getSunEditorInstance={getSunEditorInstance}\n                setOptions={editorOptions}\n            />\n        </div>\n    );\n}\n","export const WEB_API_URL = window.location.origin.indexOf('localhost') !== -1 ? 'http://localhost:5000/api' : `${window.location.origin}/api`;","import Pako from 'pako';\nimport { WEB_API_URL } from '../config.js';\n\nexport class WebApiRepository {\n    _get_token() {\n        return localStorage.getItem('token');\n    }\n\n    async _get(endpoint) {\n        const headers = { 'Content-Type': 'application/json' };\n        const authToken = this._get_token();\n        if (authToken) {\n            headers['Authorization'] = authToken;\n        }\n        const response = await fetch(`${WEB_API_URL}${endpoint}`, {\n            method: 'GET',\n            headers: headers,\n        });\n        if (response.ok) return await response.json();\n        throw await response.json();\n    }\n\n    async _post(endpoint, body) {\n        const headers = { 'Content-Type': 'application/json' };\n        const authToken = this._get_token();\n        if (authToken) {\n            headers['Authorization'] = authToken;\n        }\n        let stringBody = JSON.stringify(body);\n        let data = null;\n        if (typeof stringBody === 'string' && stringBody.length > 1024) {\n            headers['Content-Encoding'] = 'gzip';\n            data = Pako.gzip(stringBody);\n        } else {\n            // delete is slow apparently, faster to set to undefined\n            headers['Content-Encoding'] = undefined;\n            data = stringBody;\n        }\n\n        const response = await fetch(`${WEB_API_URL}${endpoint}`, {\n            method: 'POST',\n            body: data,\n            headers: headers,\n        });\n        if (response.ok) return await response.json();\n        throw await response.json();\n    }\n\n    async _put(endpoint, body) {\n        const headers = { 'Content-Type': 'application/json' };\n        const authToken = this._get_token();\n        if (authToken) {\n            headers['Authorization'] = authToken;\n        }\n        const response = await fetch(`${WEB_API_URL}${endpoint}`, {\n            method: 'PUT',\n            body: JSON.stringify(body),\n            headers: headers,\n        });\n        if (response.ok) return await response.json();\n        throw await response.json();\n    }\n\n    async _delete(endpoint, body) {\n        const headers = { 'Content-Type': 'application/json' };\n        const authToken = this._get_token();\n        if (authToken) {\n            headers['Authorization'] = authToken;\n        }\n        const response = await fetch(`${WEB_API_URL}${endpoint}`, {\n            method: 'DELETE',\n            body: JSON.stringify(body),\n            headers: headers,\n        });\n        if (response.ok) return await response.json();\n        throw await response.json();\n    }\n}\n","import { WebApiRepository } from './web-api-repository.js';\n\nexport class DnD5eCharactersRepository extends WebApiRepository {\n    static _characters = {};\n\n    async getCharacter(characterId) {\n        if (!DnD5eCharactersRepository._characters[characterId]) {\n            DnD5eCharactersRepository._characters[characterId] = await this._get(`/dnd_5e/characters/${characterId}`);\n        }\n        return DnD5eCharactersRepository._characters[characterId];\n    }\n}\n","import '../styles/CharacterStatBlock.css';\nimport React from 'react';\n\nexport function CharacterStatBlock({ character }) {\n    const get_senses = () => {\n        const passive_perception = 10 + character.skills.find((x) => x.name === 'Percepción').modifier;\n        return `Percepción pasiva ${passive_perception}`;\n    };\n\n    return (\n        <div className=\"CharacterStatBlock\">\n            <h1>\n                <a href={`https://nivel20.com/games/dnd-5/characters/${character.character_id}`}>{character.name}</a>\n            </h1>\n            <div>\n                <i>\n                    {character.class} {character.race}, {character.alignment}\n                </i>\n            </div>\n            <div className=\"divider\"></div>\n            <div>\n                <b>Clase de armadura </b>\n                <span>{character.armor_class}</span>\n            </div>\n            <div>\n                <b>Puntos de golpe </b>\n                <span>{character.max_hp}</span>\n            </div>\n            <div>\n                <b>Velocidad </b>\n                <span>{character.speed} pies</span>\n            </div>\n            <div>\n                <b>Bono de competencia </b>\n                <span>+{character.proficiency_bonus}</span>\n            </div>\n            <table>\n                <tbody>\n                    <tr>\n                        {character.ability_scores.map((ability_score) => (\n                            <th key={`${character.name}_${ability_score.name}_title`}>\n                                <b>{ability_score.name.toUpperCase().substring(0, 3)}</b>\n                            </th>\n                        ))}\n                    </tr>\n                    <tr>\n                        {character.ability_scores.map((ability_score) => (\n                            <td key={`${character.name}_${ability_score.name}_score`}>\n                                {ability_score.value} ({ability_score.modifier >= 0 ? '+' : ''}\n                                {ability_score.modifier})\n                            </td>\n                        ))}\n                    </tr>\n                </tbody>\n            </table>\n            <div>\n                <b>Tiradas de salvación </b>{' '}\n                <span>\n                    {character.saving_throws\n                        .filter((saving_throw) => saving_throw.has_proficiency)\n                        .map(\n                            (saving_throw) =>\n                                `${saving_throw.name} ${saving_throw.modifier >= 0 ? '+' : ''}${saving_throw.modifier}`\n                        )\n                        .join(', ')}\n                </span>\n            </div>\n            <div>\n                <b>Habilidades con competencia </b>{' '}\n                <span>\n                    {character.skills\n                        .filter((skill) => skill.has_proficiency)\n                        .map((skill) => `${skill.name} ${skill.modifier >= 0 ? '+' : ''}${skill.modifier}`)\n                        .join(', ')}\n                </span>\n            </div>\n            <div>\n                <b>Sentidos </b> <span>{get_senses()}</span>\n            </div>\n            <div>\n                <b>Idiomas </b> <span>{character.languages}</span>\n            </div>\n            {character.spellcasting === null ? (\n                <></>\n            ) : (\n                <>\n                    <div className=\"divider\"></div>\n                    <div>\n                        <b>Lanzamiento de conjuros </b>\n                        La habilidad de lanzamiento de conjuros de {character.name} es{' '}\n                        {character.spellcasting.spellcasting_ability} (CD de salvación de conjuros{' '}\n                        {character.spellcasting.saving_throws_cd}, {character.spellcasting.attack_bonus >= 0 ? '+' : ''}\n                        {character.spellcasting.attack_bonus} para golpear con ataques de conjuro). {character.name}{' '}\n                        tiene acceso a los siguientes conjuros:\n                        {Object.keys(character.spellcasting.spell_levels)\n                            .map((k) => parseInt(k))\n                            .map((spell_level) =>\n                                character.spellcasting.spell_levels[spell_level].max_spell_slots === 0 ? null : (\n                                    <div key={`${character.name}_spell_level_${spell_level}`}>\n                                        <i>\n                                            {spell_level === 0\n                                                ? 'Trucos (a voluntad)'\n                                                : `Nivel ${spell_level} (${character.spellcasting.spell_levels[spell_level].max_spell_slots} espacios): `}\n                                        </i>\n                                        {character.spellcasting.spell_levels[spell_level].spells.join(', ')}\n                                    </div>\n                                )\n                            )}\n                    </div>\n                </>\n            )}\n        </div>\n    );\n}\n","import React from 'react';\nimport { useState, useEffect } from 'react';\nimport { DnD5eCharactersRepository } from '../repositories/dnd5e-characters-repository';\nimport { CharacterStatBlock } from './CharacterStatBlock';\nimport ReactDOMServer from 'react-dom/server';\n\nexport function ParagraphElementComponentBodyRenderer({ appContext, body }) {\n    const [renderedBody, setRenderedBody] = useState();\n    let htmlBody = null;\n\n    useEffect(() => {\n        htmlBody = renderBody();\n        setRenderedBody(htmlBody);\n    }, [setRenderedBody, htmlBody]);\n\n    const getCharacter = async (characterId) => {\n        const repo = appContext.getRepository(DnD5eCharactersRepository);\n        const character = await repo.getCharacter(characterId);\n        document.getElementById(characterId).innerHTML = ReactDOMServer.renderToString(\n            <CharacterStatBlock character={character} />\n        );\n    };\n\n    const getCharacterTempDiv = (characterId) => {\n        return ReactDOMServer.renderToString(<div id={characterId}></div>);\n    };\n\n    const replaceCharacters = (html) => {\n        const regex = /\\[C\\]\\{([a-zA-Z0-9\\-]+)\\}/gm;\n        if (!html) return;\n        const matches = html.matchAll(regex);\n        let replaced_body = html;\n        for (const match of matches) {\n            replaced_body = replaced_body.replace(match[0], getCharacterTempDiv(match[1]));\n            setTimeout(() => getCharacter(match[1]), 0);\n        }\n        return replaced_body;\n    };\n\n    const renderBody = () => {\n        let html = replaceCharacters(body);\n        return html;\n    };\n\n    return <div dangerouslySetInnerHTML={{ __html: renderedBody }} />;\n}\n","import '../styles/ParagraphElementComponent.css';\nimport React, { useState } from 'react';\nimport { RichTextEditor } from './RichTextEditor';\nimport { ParagraphElementComponentBodyRenderer } from './ParagraphElementComponentBodyRenderer';\n\nexport function ParagraphElementComponent({ appContext, element, parentExposedFuntions }) {\n    const [editMode, setEditMode] = useState(false);\n    let currentEditorValue = null;\n    let hasChangedAtLeastOneTime = false;\n\n    const edit = () => {\n        setEditMode(true);\n    };\n\n    const save = () => {\n        if (!hasChangedAtLeastOneTime) {\n            discardChanges();\n            return;\n        }\n        element.body = currentEditorValue;\n        appContext.saveDBAsync();\n        setEditMode(false);\n    };\n\n    const discardChanges = () => {\n        currentEditorValue = null;\n        setEditMode(false);\n    };\n\n    const onBodyChange = (value) => {\n        hasChangedAtLeastOneTime = true;\n        currentEditorValue = value;\n    };\n\n    parentExposedFuntions.edit = edit;\n\n    return (\n        <div className=\"ParagraphElement\">\n            {editMode ? (\n                <>\n                    <button onClick={save}>\n                        <span role=\"img\" aria-label=\"save\">\n                            💾\n                        </span>{' '}\n                        Guardar cambios\n                    </button>\n                    <button onClick={discardChanges}>\n                        <span role=\"img\" aria-label=\"cancel\">\n                            ❌\n                        </span>{' '}\n                        Descartar cambios\n                    </button>\n                </>\n            ) : (\n                <></>\n            )}\n            {editMode ? (\n                <>\n                    <RichTextEditor onChange={onBodyChange} initialValue={element.body} />\n                </>\n            ) : (\n                <ParagraphElementComponentBodyRenderer appContext={appContext} body={element.body} />\n            )}\n        </div>\n    );\n}\n","import React, { useState } from 'react';\nimport '../styles/ParagraphElementComponent.css';\nimport { ShopItem } from '../models/shop-item';\n\nexport function ShopTableEditor({ appContext, items, onItemsChange = (items) => {}, parentExposedFuntions }) {\n    const [itemsList, setItemsList] = useState(items?.map((x) => x.clone()) || []);\n\n    const addItem = () => {\n        itemsList.push(new ShopItem());\n        onItemsChange([...itemsList]);\n        setItemsList([...itemsList]);\n    };\n\n    const removeItem = (item) => {\n        itemsList.splice(itemsList.indexOf(item), 1);\n        onItemsChange([...itemsList]);\n        setItemsList([...itemsList]);\n    };\n\n    const updateItemProp = (item, prop, value) => {\n        item[prop] = value;\n        onItemsChange([...itemsList]);\n        setItemsList([...itemsList]);\n    };\n\n    parentExposedFuntions.addItem = addItem;\n\n    return (\n        <div className=\"ShopTableEditor\">\n            <table className=\"shopTable\">\n                <tbody>\n                    <tr>\n                        <th>Objeto</th>\n                        <th>Enlace</th>\n                        <th>Precio</th>\n                        <th>Cantidad disponible</th>\n                        <th></th>\n                    </tr>\n                    {itemsList?.map((x) => (\n                        <tr key={x.id}>\n                            <td>\n                                <input\n                                    key={`${x.id}-titleInput`}\n                                    onChange={(event) => updateItemProp(x, 'title', event.target.value)}\n                                    value={x.title || ''}\n                                />\n                            </td>\n                            <td>\n                                <input\n                                    key={`${x.id}-linkInput`}\n                                    onChange={(event) => updateItemProp(x, 'link', event.target.value)}\n                                    value={x.link || ''}\n                                />\n                            </td>\n                            <td>\n                                <input\n                                    key={`${x.id}-priceInput`}\n                                    onChange={(event) => updateItemProp(x, 'price', event.target.value)}\n                                    value={x.price || ''}\n                                />\n                            </td>\n                            <td>\n                                <input\n                                    type=\"number\"\n                                    key={`${x.id}-amountInput`}\n                                    onChange={(event) => updateItemProp(x, 'amount', parseInt(event.target.value))}\n                                    value={x.amount || 0}\n                                />\n                            </td>\n                            <td>\n                                <button onClick={() => removeItem(x)}>\n                                    <span role=\"img\" aria-label=\"delete\">\n                                        🗑️\n                                    </span>\n                                </button>\n                            </td>\n                        </tr>\n                    ))}\n                </tbody>\n            </table>\n        </div>\n    );\n}\n","import '../styles/ShopElementComponent.css';\nimport React, { useState } from 'react';\nimport { ShopTableEditor } from './ShopTableEditor';\n\nexport function ShopElementComponent({ appContext, element, parentExposedFuntions }) {\n    const [editMode, setEditMode] = useState(false);\n    let currentEditorItems = null;\n    let hasChangedAtLeastOneTime = false;\n    const childFunctions = {};\n\n    const edit = () => {\n        setEditMode(true);\n    };\n\n    const save = () => {\n        if (!hasChangedAtLeastOneTime) {\n            discardChanges();\n            return;\n        }\n        element.items = currentEditorItems;\n        appContext.saveDBAsync();\n        setEditMode(false);\n    };\n\n    const discardChanges = () => {\n        currentEditorItems = [];\n        setEditMode(false);\n    };\n\n    const onItemsChange = (items) => {\n        hasChangedAtLeastOneTime = true;\n        currentEditorItems = items;\n    };\n\n    const addItem = () => {\n        childFunctions.addItem();\n    };\n\n    parentExposedFuntions.edit = edit;\n\n    return (\n        <div className=\"ParagraphElement\">\n            {editMode ? (\n                <>\n                    <button onClick={addItem}>\n                        <span role=\"img\" aria-label=\"plus\">\n                            ➕\n                        </span>{' '}\n                        Agregar objeto\n                    </button>\n                    <button onClick={save}>\n                        <span role=\"img\" aria-label=\"save\">\n                            💾\n                        </span>{' '}\n                        Guardar cambios\n                    </button>\n                    <button onClick={discardChanges}>\n                        <span role=\"img\" aria-label=\"cancel\">\n                            ❌\n                        </span>{' '}\n                        Descartar cambios\n                    </button>\n                </>\n            ) : (\n                <></>\n            )}\n            <br></br>\n            {editMode ? (\n                <>\n                    <ShopTableEditor\n                        items={element.items}\n                        onItemsChange={onItemsChange}\n                        parentExposedFuntions={childFunctions}\n                    />\n                </>\n            ) : (\n                <table className=\"shopTable\">\n                    <tbody>\n                        <tr>\n                            <th>Objeto</th>\n                            <th>Precio</th>\n                            <th>Cantidad disponible</th>\n                        </tr>\n                        {element.items.map((x) => (\n                            <tr key={x.id}>\n                                <td>{x.link ? <a href={x.link}>{x.title}</a> : <span>{x.title}</span>}</td>\n                                <td>{x.price}</td>\n                                <td>{x.amount}</td>\n                            </tr>\n                        ))}\n                    </tbody>\n                </table>\n            )}\n        </div>\n    );\n}\n","import React from 'react';\nimport { faEdit } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\n\nexport function EditIcon() {\n    return <FontAwesomeIcon icon={faEdit} color={'#574a6b'} />\n}","import React from 'react';\nimport { faLink } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\n\nexport function CopyLinkIcon() {\n    return <FontAwesomeIcon icon={faLink} color={'#424242'} />\n}","import '../styles/ViewElement.css';\nimport React, { useEffect, useState } from 'react';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport { ParagraphElementComponent } from './ParagraphElementComponent';\nimport { ShopElementComponent } from './ShopElementComponent';\nimport { RenameIcon } from './icons/RenameIcon';\nimport { EditIcon } from './icons/EditIcon';\nimport { CopyLinkIcon } from './icons/CopyLinkIcon';\n\nexport function ViewElement({ appContext }) {\n    const navigate = useNavigate();\n    const { narrativeContextId, narrativeCategoryId, elementId } = useParams();\n    const [element, setElement] = useState(null);\n    const childFuntions = {};\n\n    useEffect(() => {\n        const setNavigationButtons = () => {\n            const narrativeCategory = appContext\n                .getDB()\n                .getNarrativeContext(narrativeContextId)\n                .getNarrativeCategory(narrativeCategoryId);\n            const prevElement = narrativeCategory.getPrevElement(elementId, narrativeContextId);\n            const nextElement = narrativeCategory.getNextElement(elementId, narrativeContextId);\n            if (prevElement) {\n                appContext.setBackButtonUrl(\n                    `/narrative-context/${narrativeContextId}/${narrativeCategoryId}/${prevElement.id}`\n                );\n            } else {\n                appContext.setBackButtonUrl(`/narrative-context/${narrativeContextId}`);\n            }\n            if (nextElement) {\n                appContext.setForwardButtonUrl(\n                    `/narrative-context/${narrativeContextId}/${narrativeCategoryId}/${nextElement.id}`\n                );\n            } else {\n                appContext.setForwardButtonUrl(null);\n            }\n        };\n        appContext.setNarrativeContextById(narrativeContextId);\n\n        const obtainedElement = appContext\n            .getDB()\n            .getNarrativeContext(narrativeContextId)\n            .getNarrativeCategory(narrativeCategoryId)\n            .findElementAnywhere(elementId);\n        setElement(obtainedElement);\n\n        setNavigationButtons();\n    }, [appContext, narrativeContextId, narrativeCategoryId, elementId]);\n\n    const copyRelativeLink = () => {\n        const relLink = `${window.location.origin}/narrative-context/${narrativeContextId}/${narrativeCategoryId}/${elementId}`;\n        navigator.clipboard.writeText(relLink);\n    };\n\n    const editName = () => {\n        const name = window.prompt('Ingresa el nuevo nombre del elemento', element.name);\n        if (name) {\n            const obtainedElement = appContext\n                .getDB()\n                .getNarrativeContext(narrativeContextId)\n                .getNarrativeCategory(narrativeCategoryId)\n                .findElementAnywhere(elementId);\n            obtainedElement.name = name;\n            appContext.saveDB();\n            setElement({ ...obtainedElement });\n            setTimeout(() => {\n                setElement(obtainedElement);\n            }, 0);\n        }\n    };\n\n    const editBody = () => {\n        childFuntions.edit();\n    };\n\n    const deleteElement = () => {\n        const shouldDelete = window.confirm(`Estas seguro de eliminar el elemento ${element.name}`);\n        if (!shouldDelete) return;\n        const narrativeCategory = appContext\n            .getDB()\n            .getNarrativeContext(narrativeContextId)\n            .getNarrativeCategory(narrativeCategoryId);\n        narrativeCategory.removeElement(element.id);\n        appContext.saveDB();\n        navigate(`/narrative-context/${narrativeContextId}`);\n    };\n\n    return (\n        <div className=\"ViewElement\">\n            {element ? (\n                <>\n                    <div className=\"flex viewElementTitleBar\">\n                        <h2 className=\"flex2\">{element.name}</h2>\n                        <div className=\"textRight viewElementTitleButtons\">\n                            <button onClick={editName}>\n                                <RenameIcon />\n                                <span className=\"tooltip\">Renombrar</span>\n                            </button>\n                            <button onClick={editBody}>\n                                <EditIcon />\n                                <span className=\"tooltip\">Editar</span>\n                            </button>\n                            <button onClick={copyRelativeLink}>\n                                <CopyLinkIcon />\n                                <span className=\"tooltip\">Copiar enlace</span>\n                            </button>\n                            {/*\n                            <button onClick={deleteElement}>\n                                <DeleteIcon />\n                                <span className='tooltip'>Eliminar</span>\n                            </button>\n                            */}\n                        </div>\n                    </div>\n                    {\n                        {\n                            paragraph: (\n                                <ParagraphElementComponent\n                                    key={element.id}\n                                    appContext={appContext}\n                                    element={element}\n                                    onDelete={deleteElement}\n                                    parentExposedFuntions={childFuntions}\n                                />\n                            ),\n                            shop: (\n                                <ShopElementComponent\n                                    key={element.id}\n                                    appContext={appContext}\n                                    element={element}\n                                    onDelete={deleteElement}\n                                    parentExposedFuntions={childFuntions}\n                                />\n                            ),\n                        }[element.type]\n                    }\n                </>\n            ) : (\n                <></>\n            )}\n        </div>\n    );\n}\n","import { WebApiRepository } from './web-api-repository.js';\n\nexport class AuthRepository extends WebApiRepository {\n    onLogin = () => {};\n    onLogout = () => {};\n\n    async login(credentials) {\n        const response = await this._post(`/auth/login`, credentials);\n        localStorage.setItem('token', response.token);\n        localStorage.setItem('tokenUsername', credentials.username);\n        this.onLogin();\n    }\n\n    isAuthenticated() {\n        return !!localStorage.getItem('token');\n    }\n\n    getAuthenticatedUsername() {\n        return localStorage.getItem('tokenUsername');\n    }\n\n    logout() {\n        localStorage.removeItem('token');\n        localStorage.removeItem('tokenUsername');\n        this.onLogout();\n    }\n}\n","import React from 'react';\nimport { faUser } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\n\nexport function UserIcon() {\n    return <FontAwesomeIcon icon={faUser} />\n}","import React from 'react';\nimport { faSignOutAlt } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\n\nexport function LogoutIcon() {\n    return <FontAwesomeIcon icon={faSignOutAlt} color={'#424242'} />\n}","import '../styles/SessionMenuButton.css';\nimport React, { useRef } from 'react';\nimport { AuthRepository } from '../repositories/auth-repository';\nimport { UserIcon } from './icons/UserIcon';\nimport { LogoutIcon } from './icons/LogoutIcon';\n\nexport function SessionMenuButton({ appContext }) {\n    const dropdownBody = useRef();\n\n    const showDropdown = () => {\n        dropdownBody.current.classList.toggle('showDropdownBody');\n    };\n\n    const logout = () => {\n        appContext.getRepository(AuthRepository).logout();\n    };\n\n    return (\n        <div className=\"SessionMenuButton\">\n            <button className=\"sessionIconButton\" onClick={showDropdown}>\n                <UserIcon />\n            </button>\n            <div ref={dropdownBody} className=\"dropdownBody\">\n                <button onClick={logout}>\n                    <LogoutIcon /> Cerrar sesión\n                </button>\n            </div>\n        </div>\n    );\n}\n","import '../styles/Navbar.css';\nimport React, { useState } from 'react';\nimport { Link, useNavigate } from 'react-router-dom';\nimport { SessionMenuButton } from './SessionMenuButton';\nimport { AuthRepository } from '../repositories/auth-repository';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faAngleLeft, faAngleRight, faDiceD20 } from '@fortawesome/free-solid-svg-icons';\n\nexport function Navbar({ appContext }) {\n    const [backButtonUrl, setBackButtonUrl] = useState('/');\n    const [forwardButtonUrl, setForwardButtonUrl] = useState('/');\n    const [narrativeContext, setNarrativeContext] = useState(null);\n    const navigate = useNavigate();\n\n    const setNarrativeContextById = (narrativeContextId) => {\n        let obtainedNarrativeContext = null;\n        if (narrativeContextId) {\n            obtainedNarrativeContext = appContext.getDB().getNarrativeContext(narrativeContextId);\n        }\n        setNarrativeContext(obtainedNarrativeContext);\n    };\n\n    const navigateToPreviousElement = () => {\n        if (!backButtonUrl) return;\n        navigate(backButtonUrl);\n    };\n\n    const navigateToNextElement = () => {\n        if (!forwardButtonUrl) return;\n        navigate(forwardButtonUrl);\n    };\n\n    appContext.setBackButtonUrl = setBackButtonUrl;\n    appContext.setForwardButtonUrl = setForwardButtonUrl;\n    appContext._setNarrativeContextById = setNarrativeContextById;\n    appContext.navigateToPreviousElement = navigateToPreviousElement;\n    appContext.navigateToNextElement = navigateToNextElement;\n\n    return (\n        <div className=\"Navbar\">\n            <div className=\"navbarContent\">\n                <div className=\"flex1\">\n                    <Link to={`/`} id=\"homeTitleLink\">\n                        <FontAwesomeIcon icon={faDiceD20} /> Inicio\n                    </Link>\n                </div>\n                <div className=\"textCenter\">\n                    {narrativeContext ? (\n                        <Link to={`/narrative-context/${narrativeContext.id}`} id=\"narrativeContextTitleLink\">\n                            {narrativeContext.name}\n                        </Link>\n                    ) : (\n                        <></>\n                    )}\n                </div>\n                <div className=\"flex2 textRight\" id=\"nabvarNavigationIcons\">\n                    <span className={`iconButton ${backButtonUrl ? 'iconButtonActive' : 'iconButtonInactive'}`}>\n                        {backButtonUrl ? (\n                            <Link to={backButtonUrl}>\n                                <FontAwesomeIcon icon={faAngleLeft} />\n                            </Link>\n                        ) : (\n                            <FontAwesomeIcon icon={faAngleLeft} className=\"inactiveLink\" />\n                        )}\n                    </span>\n                    <span> </span>\n                    <span className={`iconButton ${forwardButtonUrl ? 'iconButtonActive' : 'iconButtonInactive'}`}>\n                        {forwardButtonUrl ? (\n                            <Link to={forwardButtonUrl}>\n                                <FontAwesomeIcon icon={faAngleRight} />\n                            </Link>\n                        ) : (\n                            <FontAwesomeIcon icon={faAngleRight} className=\"inactiveLink\" />\n                        )}\n                    </span>\n                    {appContext.getRepository(AuthRepository).isAuthenticated() ? (\n                        <SessionMenuButton appContext={appContext} />\n                    ) : (\n                        <></>\n                    )}\n                </div>\n            </div>\n        </div>\n    );\n}\n","import '../styles/LoginView.css';\nimport React, { useEffect, useState } from 'react';\nimport { AuthRepository } from '../repositories/auth-repository';\n\nexport function LoginView({ appContext }) {\n    const [username, setUsername] = useState(null);\n    const [password, setPassword] = useState(null);\n\n    useEffect(() => {\n        appContext.setBackButtonUrl(null);\n        appContext.setForwardButtonUrl(null);\n    }, [appContext]);\n\n    const login = async () => {\n        try {\n            await appContext.getRepository(AuthRepository).login({\n                username,\n                password,\n            });\n        } catch {\n            alert('Usuario o contreseña inválidos!');\n        }\n    };\n\n    return (\n        <form className=\"LoginView\" onSubmit={(e) => e.preventDefault()}>\n            <input\n                type=\"text\"\n                autoCorrect=\"off\"\n                autoCapitalize=\"off\"\n                name=\"username\"\n                onChange={(event) => setUsername(event.target.value)}\n                placeholder=\"Usuario\"\n            />\n            <input\n                type=\"password\"\n                name=\"password\"\n                onChange={(event) => setPassword(event.target.value)}\n                placeholder=\"Contraseña\"\n            />\n            <button type=\"submit\" onClick={login}>\n                Iniciar sesión\n            </button>\n        </form>\n    );\n}\n","import React, { useEffect } from 'react';\nimport { AuthRepository } from '../repositories/auth-repository';\n\nexport function LogoutView({ appContext }) {\n    useEffect(() => {\n        appContext.setBackButtonUrl(null);\n        appContext.setForwardButtonUrl(null);\n        appContext.getRepository(AuthRepository).logout();\n    }, [appContext]);\n\n    return <></>;\n}\n","import '../styles/UpdatingDBIndicator.css';\nimport React from 'react';\nimport { faCloudUploadAlt } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\n\nexport function UpdatingDBIndicator() {\n    return (\n        <div className=\"UpdatingDBIndicator\">\n            <FontAwesomeIcon className=\"updatingDBIcon\" icon={faCloudUploadAlt} />\n        </div>\n    );\n}\n","import '../styles/SearchBar.css';\nimport React, { useState, useEffect } from 'react';\nimport { Link, useNavigate } from 'react-router-dom';\n\nlet _searchResults = [];\nlet _resultIndex = -1;\n\nexport function SearchBar({ appContext }) {\n    const navigate = useNavigate();\n\n    const [searchResults, setSearchResults] = useState([]);\n    const [resultIndex, setResultIndex] = useState(-1);\n\n    const moveIndexUp = () => {\n        if (_searchResults.length === 0) {\n            _resultIndex = -1;\n            setResultIndex(_resultIndex);\n            return;\n        }\n        _resultIndex--;\n        if (_resultIndex < 0) {\n            _resultIndex = 0;\n        }\n        setResultIndex(_resultIndex);\n    };\n\n    const moveIndexDown = () => {\n        if (_searchResults.length === 0) {\n            _resultIndex = -1;\n            setResultIndex(_resultIndex);\n            return;\n        }\n        _resultIndex++;\n        if (_resultIndex > _searchResults.length - 1) {\n            _resultIndex = _searchResults.length - 1;\n        }\n        setResultIndex(_resultIndex);\n    };\n\n    const generateElementLink = (element) => {\n        const db = appContext.getDB();\n        const narrativeContext = db.getNarrativeContext(appContext.getNarrativeContextId());\n        const narrativeCategory = narrativeContext.getNarrativeCategoryByElementId(element.id);\n        return `/narrative-context/${appContext.getNarrativeContextId()}/${narrativeCategory.id}/${element.id}`;\n    };\n\n    const navigateToElement = () => {\n        if (_resultIndex === -1) return;\n        navigate(generateElementLink(_searchResults[_resultIndex]));\n        appContext.hideSearchBar();\n    };\n\n    const moveIndex = (event) => {\n        if (event.key === 'ArrowUp') {\n            event.preventDefault();\n            moveIndexUp();\n            scrollToSeletedResult();\n            return;\n        }\n        if (event.key === 'ArrowDown') {\n            event.preventDefault();\n            moveIndexDown();\n            scrollToSeletedResult();\n            return;\n        }\n        if (event.key === 'Enter') {\n            event.preventDefault();\n            navigateToElement();\n            return;\n        }\n    };\n\n    const scrollToSeletedResult = () => {\n        const element = document.getElementById(`searchResult_${_resultIndex}`);\n        if (element) {\n            element.scrollIntoView(true);\n        }\n    };\n\n    useEffect(() => {\n        // Anything in here is fired on component mount.\n        document.addEventListener('keydown', moveIndex);\n        search('');\n        return () => {\n            // Anything in here is fired on component unmount.\n            document.removeEventListener('keydown', moveIndex);\n        };\n    }, []);\n\n    const search = (term) => {\n        /*if (!term) {\n            _searchResults = [];\n            _resultIndex = -1;\n            setSearchResults(_searchResults);\n            setResultIndex(_resultIndex);\n            return;\n        }*/\n        const db = appContext.getDB();\n        const narrativeContextId = appContext.getNarrativeContextId();\n        if (narrativeContextId) {\n            const elements = db.searchTerm(term, narrativeContextId);\n            _searchResults = elements;\n            _resultIndex = elements.length > 0 ? 0 : -1;\n        } else {\n            _searchResults = [];\n            _resultIndex = -1;\n        }\n        setSearchResults(_searchResults);\n        setResultIndex(_resultIndex);\n    };\n\n    return (\n        <div className=\"SearchBar\">\n            <div className=\"searchBarInputContainer\">\n                <input\n                    autoFocus\n                    key=\"searchBarTextInput\"\n                    onChange={(event) => search(event.target.value)}\n                    placeholder=\"Ingrese el término a buscar\"\n                    className=\"searchBarInput\"\n                />\n            </div>\n            <div className=\"searchResultsContainer\">\n                {searchResults.map((element, i) => (\n                    <div\n                        className={i === resultIndex ? 'searchResult searchResultSelected' : 'searchResult'}\n                        id={`searchResult_${i}`}\n                        key={`searchResult_${i}`}\n                    >\n                        <Link to={generateElementLink(element)} onClick={() => appContext.hideSearchBar()}>\n                            {element.name}\n                        </Link>\n                    </div>\n                ))}\n            </div>\n        </div>\n    );\n}\n","import './styles/App.css';\nimport './styles.css';\nimport React, { useState } from 'react';\nimport {\n    BrowserRouter as Router,\n    Routes,\n    Route,\n    Navigate,\n    //Link\n} from 'react-router-dom';\nimport { Home } from './components/Home';\nimport { CreateNarrativeContext } from './components/CreateNarrativeContext';\nimport { ViewNarrativeContext } from './components/ViewNarrativeContext';\nimport { ViewElement } from './components/ViewElement';\nimport { Navbar } from './components/Navbar';\nimport { LoginView } from './components/LoginView';\nimport { AuthRepository } from './repositories/auth-repository';\nimport { LogoutView } from './components/LogoutView';\nimport { UpdatingDBIndicator } from 'components/UpdatingDBIndicator';\nimport { SearchBar } from 'components/SearchBar';\n\nexport function App({ appContext }) {\n    const authRepo = appContext.getRepository(AuthRepository);\n\n    const [userLogged] = useState(authRepo.isAuthenticated());\n    const [updatingDB, setUpdatingDB] = useState(false);\n    const [searchBarDisplayed, setSearchBarDisplayed] = useState(false);\n\n    appContext.setUpdatingDBIndicator = setUpdatingDB;\n    appContext.showSearchBar = () => setSearchBarDisplayed(true);\n    appContext.hideSearchBar = () => setSearchBarDisplayed(false);\n\n    return (\n        <div className=\"App\">\n            {updatingDB ? <UpdatingDBIndicator /> : <></>}\n            <Router>\n                <Navbar appContext={appContext} />\n                {searchBarDisplayed ? <SearchBar appContext={appContext} /> : <></>}\n                <div className=\"RouterContainer\">\n                    <Routes>\n                        {userLogged ? (\n                            <>\n                                <Route\n                                    path=\"/create-narrative-context\"\n                                    element={<CreateNarrativeContext appContext={appContext} />}\n                                />\n                                <Route\n                                    path=\"/narrative-context/:narrativeContextId/:narrativeCategoryId/:elementId\"\n                                    element={<ViewElement appContext={appContext} />}\n                                />\n                                <Route\n                                    path=\"/narrative-context/:narrativeContextId\"\n                                    element={<ViewNarrativeContext appContext={appContext} />}\n                                />\n                                <Route path=\"/logout\" element={<LogoutView appContext={appContext} />} />\n                                <Route path=\"/\" element={<Home appContext={appContext} />} />\n                                <Route path=\"*\" element={<Navigate to=\"/\" />} />\n                            </>\n                        ) : (\n                            <>\n                                <Route path=\"/login\" element={<LoginView appContext={appContext} />} />\n                                <Route path=\"*\" element={<Navigate to=\"/login\" />} />\n                                <Route path=\"/\" element={<Navigate to=\"/login\" />} />\n                            </>\n                        )}\n                    </Routes>\n                </div>\n            </Router>\n        </div>\n    );\n}\n","import { NarrativeContext } from './narrative-context';\n\nexport class Database {\n    campaigns = null; // Array of NarrativeContext\n    worlds = null; // Array of NarrativeContext\n\n    constructor() {\n        this.campaigns = [];\n        this.worlds = [];\n    }\n\n    getNarrativeContext(narrativeContextId) {\n        return this.campaigns.concat(this.worlds).find((x) => x.id === narrativeContextId);\n    }\n\n    addNarrativeContext(narrativeContext) {\n        if (narrativeContext.type === 'world') {\n            this.addWorld(narrativeContext);\n        } else {\n            this.addCampaign(narrativeContext);\n        }\n    }\n\n    removeNarrativeContext(narrativeContextId) {\n        const narrativeContext = this.getNarrativeContext(narrativeContextId);\n        let narrativeContextsList = null;\n        if (narrativeContext.type === 'world') {\n            narrativeContextsList = this.worlds;\n        } else {\n            narrativeContextsList = this.campaigns;\n        }\n        narrativeContextsList.splice(narrativeContextsList.indexOf(narrativeContext), 1);\n    }\n\n    addWorld(world) {\n        this.worlds.push(world);\n    }\n\n    addCampaign(campaign) {\n        this.campaigns.push(campaign);\n    }\n\n    toJson() {\n        return {\n            campaigns: this.campaigns.map((x) => x.toJson()),\n            worlds: this.worlds.map((x) => x.toJson()),\n        };\n    }\n\n    static fromJson(data) {\n        const instance = new Database();\n        instance.campaigns = data['campaigns'].map((x) => NarrativeContext.fromJson(x));\n        instance.worlds = data['worlds'].map((x) => NarrativeContext.fromJson(x));\n        return instance;\n    }\n\n    searchTerm(term, narrativeContextId) {\n        return this.getNarrativeContext(narrativeContextId).searchTerm(term);\n    }\n}\n","import { WebApiRepository } from './web-api-repository';\nimport { Database } from '../models/database';\n\nexport class DBSyncRepository extends WebApiRepository {\n    async pullDB() {\n        const db = await this._get('/database');\n        if (Object.keys(db).length === 0) return null;\n        return Database.fromJson(db);\n    }\n\n    async pushDB(dbJson) {\n        await this._post('/database', dbJson);\n    }\n}\n","import { Database } from '../models/database';\nimport { DBSyncRepository } from './db-sync-repository';\n\nexport class DBRepository {\n    static _DB_KEY = 'db';\n    static _db = null;\n    static _afterSaveHooks = [];\n    static _preventSave = false;\n    static _onDirtyDBCallback = () => {};\n    static _dbSyncRepository = new DBSyncRepository();\n    static _onCloudDBDownloadedHooks = [];\n    static setUpdatingDBIndicator = (value) => {};\n\n    constructor() {\n        DBRepository._db = new Database();\n    }\n\n    async tryGetCloudDB() {\n        await DBRepository._tryDownloadCloudDB();\n    }\n\n    static async _tryDownloadCloudDB() {\n        console.log('Downloading remote DB');\n        const downloadedDB = await DBRepository._dbSyncRepository.pullDB();\n        if (downloadedDB) {\n            DBRepository._db = downloadedDB;\n            for (const hook of DBRepository._onCloudDBDownloadedHooks) {\n                hook();\n            }\n        }\n    }\n\n    registerOnCloudDBDownloadedHook(hook) {\n        DBRepository._onCloudDBDownloadedHooks.push(hook);\n    }\n\n    static async _save() {\n        if (DBRepository._preventSave) {\n            DBRepository._onDirtyDBCallback();\n            return;\n        }\n        DBRepository.setUpdatingDBIndicator(true);\n        await DBRepository._dbSyncRepository.pushDB(DBRepository._db.toJson());\n        DBRepository._callAfterSaveHooks();\n        DBRepository.setUpdatingDBIndicator(false);\n    }\n\n    registerAfterSaveHook(hook) {\n        DBRepository._afterSaveHooks.push(hook);\n    }\n\n    static _callAfterSaveHooks() {\n        for (const hook of DBRepository._afterSaveHooks) {\n            hook();\n        }\n    }\n\n    registerOnDirtyDBCallback(callback) {\n        DBRepository._onDirtyDBCallback = callback;\n    }\n\n    enableSavingPrevention() {\n        DBRepository._preventSave = true;\n    }\n\n    save() {\n        DBRepository._save();\n    }\n}\n","import { DBRepository } from './repositories/db-repository';\n\nexport class AppContext {\n    _repositories = null;\n    _narrativeContextId = null;\n    setUpdatingDBIndicator = (status) => {};\n    elementListItemExpandedStatuses = {};\n\n    constructor() {\n        this._repositories = {};\n    }\n\n    getRepository(repositoryClass) {\n        if (!this._repositories[repositoryClass]) {\n            this._repositories[repositoryClass] = new repositoryClass();\n        }\n        return this._repositories[repositoryClass];\n    }\n\n    // To be overrided\n    setBackButtonUrl(url) {}\n\n    // To be overrided\n    setForwardButtonUrl(url) {}\n\n    // To be overrided\n    _setNarrativeContextById(narrativeContextId) {}\n\n    setNarrativeContextById(narrativeContextId) {\n        this._narrativeContextId = narrativeContextId;\n        this._setNarrativeContextById(narrativeContextId);\n    }\n\n    getNarrativeContextId() {\n        return this._narrativeContextId;\n    }\n\n    getDB() {\n        return DBRepository._db;\n    }\n\n    saveDBAsync() {\n        setTimeout(() => this.saveDB(), 0);\n    }\n\n    async saveDB() {\n        DBRepository.setUpdatingDBIndicator = this.setUpdatingDBIndicator;\n        // console.log('Enviando datos al servidor de la aplicación...');\n        try {\n            await DBRepository._save();\n            // console.log('Los datos se enviaron al servidor correctamente!');\n        } catch {\n            alert('Ha ocurrido un error al tratar de enviar los cambios al servidor de la aplicación!');\n        }\n    }\n\n    // To be overrided\n    showSearchBar() {}\n\n    // To be overrided\n    hideSearchBar() {}\n\n    triggerEvent(eventName) {\n        if (eventName === 'open_search') {\n            this.showSearchBar();\n            return;\n        }\n        if (eventName === 'close_search') {\n            this.hideSearchBar();\n            return;\n        }\n    }\n\n    // To be overrided\n    navigateToPreviousElement() {}\n    // To be overrided\n    navigateToNextElement() {}\n}\n","import { DBRepository } from '../repositories/db-repository';\n\nexport class DataCorruptionPreventer {\n    _appContext = null;\n    _interval = null;\n    _INTERVAL_TIME = 2000;\n    _lastDBSaveTime = null;\n    _LAST_SAVE_DATE_KEY = 'last_save_date';\n\n    constructor(appContext) {\n        this._appContext = appContext;\n        this._lastDBSaveTime = this._getStoredDate();\n        this._registerAfterSaveHook();\n        this._registerOnDirtyDBCallback();\n    }\n\n    _registerAfterSaveHook() {\n        this._appContext.getRepository(DBRepository).registerAfterSaveHook(() => {\n            this._updateLastSaveInfo();\n        });\n    }\n\n    _registerOnDirtyDBCallback() {\n        this._appContext.getRepository(DBRepository).registerOnDirtyDBCallback(() => {\n            this._onDirtyDB();\n        });\n    }\n\n    _updateLastSaveInfo() {\n        const saveDate = new Date();\n        this._lastDBSaveTime = saveDate;\n        localStorage.setItem(this._LAST_SAVE_DATE_KEY, saveDate.toString());\n    }\n\n    _getStoredDate() {\n        const lastSaveDateStr = localStorage.getItem(this._LAST_SAVE_DATE_KEY);\n        if (!lastSaveDateStr) return null;\n        return new Date(lastSaveDateStr);\n    }\n\n    _isWorkingDirty() {\n        const storedDate = this._getStoredDate();\n        return (\n            (storedDate && !this._lastDBSaveTime) ||\n            (storedDate && this._lastDBSaveTime && this._lastDBSaveTime < storedDate)\n        );\n    }\n\n    start() {\n        this._interval = setInterval(() => {\n            if (this._isWorkingDirty()) {\n                this._appContext.getRepository(DBRepository).enableSavingPrevention();\n                clearInterval(this._interval);\n                this._onDirtyDB();\n            }\n        }, this._INTERVAL_TIME);\n    }\n\n    _onDirtyDB() {\n        const shouldReload = window.confirm(\n            'Usted esta trabajando con una version desactualizada de la base de datos local y no podra guardar cambios en esta.' +\n                ' Por favor recargue la aplicación para poder volver a utilizarla con normalidad o haga click en aceptar / ok para hacerlo automáticamente.'\n        );\n        if (shouldReload) window.location.reload();\n    }\n}\n","export class KeyboardShortcutsHandler {\n    _pressedKeys = [];\n\n    constructor(appContext) {\n        this._appContext = appContext;\n    }\n\n    _addPressedKey(key) {\n        if (!this._pressedKeys.find((x) => x === key)) {\n            this._pressedKeys.push(key);\n        }\n    }\n\n    _tryRemovePressedKey = (key) => {\n        const index = this._pressedKeys.indexOf(key);\n        if (index !== -1) {\n            this._pressedKeys.splice(index, 1);\n        }\n    };\n\n    _keyPressed(key) {\n        return this._pressedKeys.indexOf(key) !== -1;\n    }\n\n    registerKeyboardShortcuts() {\n        document.addEventListener('keydown', (event) => {\n            this._addPressedKey(event.key);\n\n            // Prevent default ctrl + p\n            if (this._keyPressed('Control') && event.key === 'p') {\n                event.preventDefault();\n                this._appContext.triggerEvent('open_search');\n                return;\n            }\n\n            if (event.key === 'Escape') {\n                this._appContext.triggerEvent('close_search');\n                return;\n            }\n\n            /*\n            // Navigate to previous element\n            if (this._keyPressed('Alt') && event.key === 'ArrowLeft') {\n                event.preventDefault();\n                this._appContext.navigateToPreviousElement();\n                return;\n            }\n            \n            // Navigate to next element\n            if (this._keyPressed('Alt') && event.key === 'ArrowRight') {\n                event.preventDefault();\n                this._appContext.navigateToNextElement();\n                return;\n            }\n            */\n        });\n        document.addEventListener('keyup', (event) => {\n            this._tryRemovePressedKey(event.key);\n        });\n    }\n}\n","import './index.css';\nimport React from 'react';\nimport ReactDom from 'react-dom';\nimport { App } from './App';\nimport { AppContext } from './app-context';\nimport { DataCorruptionPreventer } from './services/data-corruption-preventer';\nimport { DBRepository } from './repositories/db-repository';\nimport { AuthRepository } from './repositories/auth-repository';\nimport { KeyboardShortcutsHandler } from 'utils/keyboard-shorcuts-handler';\n\nconst appContext = new AppContext();\nconst dataCorruptionPreventer = new DataCorruptionPreventer(appContext);\nconst keyboardShortcutsHandler = new KeyboardShortcutsHandler(appContext);\nconst dbRepo = appContext.getRepository(DBRepository);\nconst authRepo = appContext.getRepository(AuthRepository);\n\nconst renderApp = () => {\n    ReactDom.render(<App appContext={appContext} />, document.getElementById('root'));\n};\n\n// Just download the remote DB if use is logged in\nconst start = async () => {\n    try {\n        if (authRepo.isAuthenticated()) {\n            await dbRepo.tryGetCloudDB();\n        }\n        dataCorruptionPreventer.start();\n        keyboardShortcutsHandler.registerKeyboardShortcuts();\n        renderApp();\n    } catch {\n        alert('Ha ocurrido un error al sincronizar con el servidor, por favor refresca la página!');\n    }\n};\n\nauthRepo.onLogin = () => {\n    window.location = '/';\n};\n\nauthRepo.onLogout = () => {\n    window.location = '/login';\n};\n\nstart();\n"],"sourceRoot":""}